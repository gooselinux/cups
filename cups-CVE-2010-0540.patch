diff -up cups-1.4.2/cgi-bin/cgi.h.CVE-2010-0540 cups-1.4.2/cgi-bin/cgi.h
--- cups-1.4.2/cgi-bin/cgi.h.CVE-2010-0540	2009-11-09 23:01:17.000000000 +0000
+++ cups-1.4.2/cgi-bin/cgi.h	2010-07-16 16:57:40.598948567 +0100
@@ -1,9 +1,9 @@
 /*
  * "$Id: cgi.h 8859 2009-11-09 23:01:17Z mike $"
  *
- *   CGI support library definitions.
+ *   CGI support library definitions for CUPS.
  *
- *   Copyright 2007-2009 by Apple Inc.
+ *   Copyright 2007-2010 by Apple Inc.
  *   Copyright 1997-2006 by Easy Software Products.
  *
  *   These coded instructions, statements, and computer programs are the
@@ -61,11 +61,12 @@ extern void		cgiCopyTemplateLang(const c
 extern int		cgiDoSearch(void *search, const char *text);
 extern void		cgiEndHTML(void);
 extern void		cgiEndMultipart(void);
-extern char		*cgiFormEncode(char *dst, const char *src, size_t dstsize);
+extern char		*cgiFormEncode(char *dst, const char *src,
+			               size_t dstsize);
 extern void		cgiFreeSearch(void *search);
 extern const char	*cgiGetArray(const char *name, int element);
 extern void		cgiGetAttributes(ipp_t *request, const char *tmpl);
-extern char		*cgiGetCookie(const char *name, char *buf, int buflen);
+extern const char	*cgiGetCookie(const char *name);
 extern const cgi_file_t	*cgiGetFile(void);
 extern cups_array_t	*cgiGetIPPObjects(ipp_t *response, void *search);
 extern int		cgiGetSize(const char *name);
diff -up cups-1.4.2/cgi-bin/libcupscgi.exp.CVE-2010-0540 cups-1.4.2/cgi-bin/libcupscgi.exp
--- cups-1.4.2/cgi-bin/libcupscgi.exp.CVE-2010-0540	2009-11-09 23:01:17.000000000 +0000
+++ cups-1.4.2/cgi-bin/libcupscgi.exp	2010-07-16 16:57:40.598948567 +0100
@@ -10,6 +10,7 @@ _cgiFormEncode
 _cgiFreeSearch
 _cgiGetArray
 _cgiGetAttributes
+_cgiGetCookie
 _cgiGetFile
 _cgiGetIPPObjects
 _cgiGetSize
@@ -24,6 +25,7 @@ _cgiRewriteURL
 _cgiSetArray
 _cgiSetIPPObjectVars
 _cgiSetIPPVars
+_cgiSetCookie
 _cgiSetServerVersion
 _cgiSetSize
 _cgiSetVariable
diff -up cups-1.4.2/cgi-bin/template.c.CVE-2010-0540 cups-1.4.2/cgi-bin/template.c
--- cups-1.4.2/cgi-bin/template.c.CVE-2010-0540	2009-11-09 23:01:17.000000000 +0000
+++ cups-1.4.2/cgi-bin/template.c	2010-07-16 16:57:40.606073113 +0100
@@ -369,6 +369,20 @@ cgi_copy(FILE *out,			/* I - Output file
 
         continue;
       }
+      else if (name[0] == '$')
+      {
+       /*
+        * Insert cookie value or nothing if not defined.
+	*/
+
+        if ((value = cgiGetCookie(name + 1)) != NULL)
+	  outptr = value;
+	else
+	{
+	  outval[0] = '\0';
+	  outptr    = outval;
+	}
+      }
       else
       {
        /*
diff -up cups-1.4.2/cgi-bin/var.c.CVE-2010-0540 cups-1.4.2/cgi-bin/var.c
--- cups-1.4.2/cgi-bin/var.c.CVE-2010-0540	2009-11-09 23:01:17.000000000 +0000
+++ cups-1.4.2/cgi-bin/var.c	2010-07-16 16:57:40.606948785 +0100
@@ -1,9 +1,9 @@
 /*
  * "$Id: var.c 8859 2009-11-09 23:01:17Z mike $"
  *
- *   CGI form variable and array functions.
+ *   CGI form variable and array functions for CUPS.
  *
- *   Copyright 2007-2009 by Apple Inc.
+ *   Copyright 2007-2010 by Apple Inc.
  *   Copyright 1997-2005 by Easy Software Products.
  *
  *   These coded instructions, statements, and computer programs are the
@@ -14,25 +14,34 @@
  *
  * Contents:
  *
- *   cgiCheckVariables()        - Check for the presence of "required" variables.
+ *   cgiCheckVariables()        - Check for the presence of "required"
+ *                                variables.
  *   cgiClearVariables()        - Clear all form variables.
- *   cgiGetArray()              - Get an element from a form array...
- *   cgiGetFile()               - Get the file (if any) that was submitted in the form.
+ *   cgiGetArray()              - Get an element from a form array.
+ *   cgiGetCookie()             - Get a cookie value.
+ *   cgiGetFile()               - Get the file (if any) that was submitted in
+ *                                the form.
  *   cgiGetSize()               - Get the size of a form array value.
- *   cgiGetVariable()           - Get a CGI variable from the database...
- *   cgiInitialize()            - Initialize the CGI variable "database"...
+ *   cgiGetVariable()           - Get a CGI variable from the database.
+ *   cgiInitialize()            - Initialize the CGI variable "database".
  *   cgiIsPOST()                - Determine whether this page was POSTed.
  *   cgiSetArray()              - Set array element N to the specified string.
+ *   cgiSetCookie()             - Set a cookie value.
  *   cgiSetSize()               - Set the array size.
- *   cgiSetVariable()           - Set a CGI variable in the database...
+ *   cgiSetVariable()           - Set a CGI variable in the database.
  *   cgi_add_variable()         - Add a form variable.
  *   cgi_compare_variables()    - Compare two variables.
- *   cgi_find_variable()        - Find a variable...
- *   cgi_initialize_get()       - Initialize form variables using the GET method.
- *   cgi_initialize_multipart() - Initialize variables and file using the POST method.
+ *   cgi_find_variable()        - Find a variable.
+ *   cgi_initialize_cookies()   - Initialize cookies.
+ *   cgi_initialize_get()       - Initialize form variables using the GET
+ *                                method.
+ *   cgi_initialize_multipart() - Initialize variables and file using the POST
+ *                                method.
  *   cgi_initialize_post()      - Initialize variables using the POST method.
  *   cgi_initialize_string()    - Initialize form variables from a string.
- *   cgi_passwd()               - Catch authentication requests and notify the server.
+ *   cgi_passwd()               - Catch authentication requests and notify the
+ *                                server.
+ *   cgi_set_sid()              - Set the CUPS session ID.
  *   cgi_sort_variables()       - Sort all form variables for faster lookup.
  *   cgi_unlink_file()          - Remove the uploaded form.
  */
@@ -40,6 +49,15 @@
 /*#define DEBUG*/
 #include "cgi-private.h"
 #include <errno.h>
+#include <cups/http.h>
+#include <cups/md5.h>
+
+
+/*
+ * Session ID name
+ */
+
+#define CUPS_SID	"org.cups.sid"
 
 
 /*
@@ -59,6 +77,8 @@ typedef struct				/**** Form variable st
  * Local globals...
  */
 
+static int		num_cookies = 0;/* Number of cookies */
+static cups_option_t	*cookies = NULL;/* Cookies */
 static int		form_count = 0,	/* Form variable count */
 			form_alloc = 0;	/* Number of variables allocated */
 static _cgi_var_t	*form_vars = NULL;
@@ -76,11 +96,13 @@ static void		cgi_add_variable(const char
 static int		cgi_compare_variables(const _cgi_var_t *v1,
 			                      const _cgi_var_t *v2);
 static _cgi_var_t	*cgi_find_variable(const char *name);
+static void		cgi_initialize_cookies(void);
 static int		cgi_initialize_get(void);
 static int		cgi_initialize_multipart(const char *boundary);
 static int		cgi_initialize_post(void);
 static int		cgi_initialize_string(const char *data);
 static const char	*cgi_passwd(const char *prompt);
+static const char	*cgi_set_sid(void);
 static void		cgi_sort_variables(void);
 static void		cgi_unlink_file(void);
 
@@ -161,7 +183,7 @@ cgiClearVariables(void)
 
 
 /*
- * 'cgiGetArray()' - Get an element from a form array...
+ * 'cgiGetArray()' - Get an element from a form array.
  */
 
 const char *				/* O - Element value or NULL */
@@ -182,6 +204,17 @@ cgiGetArray(const char *name,		/* I - Na
 
 
 /*
+ * 'cgiGetCookie()' - Get a cookie value.
+ */
+
+const char *				/* O - Value or NULL */
+cgiGetCookie(const char *name)		/* I - Name of cookie */
+{
+  return (cupsGetOption(name, num_cookies, cookies));
+}
+
+
+/*
  * 'cgiGetFile()' - Get the file (if any) that was submitted in the form.
  */
 
@@ -210,10 +243,10 @@ cgiGetSize(const char *name)		/* I - Nam
 
 
 /*
- * 'cgiGetVariable()' - Get a CGI variable from the database...
+ * 'cgiGetVariable()' - Get a CGI variable from the database.
  *
  * Returns NULL if the variable doesn't exist.  If the variable is an
- * array of values, returns the last element...
+ * array of values, returns the last element.
  */
 
 const char *				/* O - Value of variable */
@@ -237,14 +270,16 @@ cgiGetVariable(const char *name)	/* I - 
 
 
 /*
- * 'cgiInitialize()' - Initialize the CGI variable "database"...
+ * 'cgiInitialize()' - Initialize the CGI variable "database".
  */
 
 int					/* O - Non-zero if there was form data */
 cgiInitialize(void)
 {
-  const char	*method;		/* Form posting method */
-  const char	*content_type;		/* Content-Type of post data */
+  const char	*method,		/* Form posting method */
+		*content_type,		/* Content-Type of post data */
+		*cups_sid_cookie,	/* SID cookie */
+		*cups_sid_form;		/* SID form variable */
 
 
  /*
@@ -268,6 +303,20 @@ cgiInitialize(void)
 #endif /* DEBUG */
 
  /*
+  * Get cookies...
+  */
+
+  cgi_initialize_cookies();
+
+  if ((cups_sid_cookie = cgiGetCookie(CUPS_SID)) == NULL)
+  {
+    fputs("DEBUG: " CUPS_SID " cookie not found, initializing!\n", stderr);
+    cups_sid_cookie = cgi_set_sid();
+  }
+
+  fprintf(stderr, "DEBUG: " CUPS_SID " cookie is \"%s\"\n", cups_sid_cookie);
+
+ /*
   * Get the request method (GET or POST)...
   */
 
@@ -290,9 +339,27 @@ cgiInitialize(void)
       boundary += 9;
 
     if (content_type && !strncmp(content_type, "multipart/form-data; ", 21))
-      return (cgi_initialize_multipart(boundary));
+    {
+      if (!cgi_initialize_multipart(boundary))
+        return (0);
+    }
+    else if (!cgi_initialize_post())
+      return (0);
+
+    if ((cups_sid_form = cgiGetVariable(CUPS_SID)) == NULL ||
+	strcmp(cups_sid_cookie, cups_sid_form))
+    {
+      if (cups_sid_form)
+	fprintf(stderr, "DEBUG: " CUPS_SID " form variable is \"%s\"\n",
+	        cups_sid_form);
+      else
+	fputs("DEBUG: " CUPS_SID " form variable is not present.\n", stderr);
+
+      cgiClearVariables();
+      return (0);
+    }
     else
-      return (cgi_initialize_post());
+      return (1);
   }
   else
     return (0);
@@ -371,6 +438,38 @@ cgiSetArray(const char *name,		/* I - Na
 
 
 /*
+ * 'cgiSetCookie()' - Set a cookie value.
+ */
+
+void
+cgiSetCookie(const char *name,		/* I - Name */
+             const char *value,		/* I - Value */
+             const char *path,		/* I - Path (typically "/") */
+	     const char *domain,	/* I - Domain name */
+	     time_t     expires,	/* I - Expiration date (0 for session) */
+	     int        secure)		/* I - Require SSL */
+{
+  num_cookies = cupsAddOption(name, value, num_cookies, &cookies);
+
+  printf("Set-Cookie: %s=%s;", name, value);
+  if (path)
+    printf("; path=%s", path);
+  if (domain)
+    printf("; domain=%s", domain);
+  if (expires)
+  {
+    char	date[256];		/* Date string */
+
+    printf("; expires=%s", httpGetDateString2(expires, date, sizeof(date)));
+  }
+  if (secure)
+    puts("; secure;");
+  else
+    puts(";");
+}
+
+
+/*
  * 'cgiSetSize()' - Set the array size.
  */
 
@@ -418,7 +517,7 @@ cgiSetSize(const char *name,		/* I - Nam
 
 
 /*
- * 'cgiSetVariable()' - Set a CGI variable in the database...
+ * 'cgiSetVariable()' - Set a CGI variable in the database.
  *
  * If the variable is an array, this truncates the array to a single element.
  */
@@ -514,7 +613,7 @@ cgi_compare_variables(
 
 
 /*
- * 'cgi_find_variable()' - Find a variable...
+ * 'cgi_find_variable()' - Find a variable.
  */
 
 static _cgi_var_t *			/* O - Variable pointer or NULL */
@@ -534,6 +633,91 @@ cgi_find_variable(const char *name)	/* I
 
 
 /*
+ * 'cgi_initialize_cookies()' - Initialize cookies.
+ */
+
+static void
+cgi_initialize_cookies(void)
+{
+  const char	*cookie;		/* HTTP_COOKIE environment variable */
+  char		name[128],		/* Name string */
+		value[512],		/* Value string */
+		*ptr;			/* Pointer into name/value */
+
+
+  if ((cookie = getenv("HTTP_COOKIE")) == NULL)
+    return;
+
+  while (*cookie)
+  {
+   /*
+    * Skip leading whitespace...
+    */
+
+    while (isspace(*cookie & 255))
+      cookie ++;
+    if (!*cookie)
+      break;
+
+   /*
+    * Copy the name...
+    */
+
+    for (ptr = name; *cookie && *cookie != '=';)
+      if (ptr < (name + sizeof(name) - 1))
+        *ptr++ = *cookie++;
+      else
+        break;
+
+    if (*cookie != '=')
+      break;
+
+    *ptr = '\0';
+    cookie ++;
+
+   /*
+    * Then the value...
+    */
+
+    if (*cookie == '\"')
+    {
+      for (cookie ++, ptr = value; *cookie && *cookie != '\"';)
+        if (ptr < (value + sizeof(value) - 1))
+	  *ptr++ = *cookie++;
+	else
+	  break;
+
+      if (*cookie == '\"')
+        cookie ++;
+    }
+    else
+    {
+      for (ptr = value; *cookie && *cookie != ';';)
+        if (ptr < (value + sizeof(value) - 1))
+	  *ptr++ = *cookie++;
+	else
+	  break;
+    }
+
+    if (*cookie == ';')
+      cookie ++;
+    else if (*cookie)
+      break;
+
+    *ptr = '\0';
+
+   /*
+    * Then add the cookie to an array as long as the name doesn't start with
+    * "$"...
+    */
+
+    if (name[0] != '$')
+      num_cookies = cupsAddOption(name, value, num_cookies, &cookies);
+  }
+}
+
+
+/*
  * 'cgi_initialize_get()' - Initialize form variables using the GET method.
  */
 
@@ -562,7 +746,8 @@ cgi_initialize_get(void)
 
 
 /*
- * 'cgi_initialize_multipart()' - Initialize variables and file using the POST method.
+ * 'cgi_initialize_multipart()' - Initialize variables and file using the POST
+ *                                method.
  *
  * TODO: Update to support files > 2GB.
  */
@@ -874,7 +1059,7 @@ cgi_initialize_string(const char *data)	
   char	*s,				/* Pointer to current form string */
 	ch,				/* Temporary character */
 	name[255],			/* Name of form variable */
-	value[65536];			/* Variable value... */
+	value[65536];			/* Variable value */
 
 
  /*
@@ -1015,6 +1200,45 @@ cgi_passwd(const char *prompt)		/* I - P
 
 
 /*
+ * 'cgi_set_sid()' - Set the CUPS session ID.
+ */
+
+static const char *			/* O - New session ID */
+cgi_set_sid(void)
+{
+  char			buffer[512],	/* SID data */
+			sid[33];	/* SID string */
+  _cups_md5_state_t	md5;		/* MD5 state */
+  unsigned char		sum[16];	/* MD5 sum */
+  const char		*remote_addr,	/* REMOTE_ADDR */
+			*server_name,	/* SERVER_NAME */
+			*server_port;	/* SERVER_PORT */
+
+
+  if ((remote_addr = getenv("REMOTE_ADDR")) == NULL)
+    remote_addr = "REMOTE_ADDR";
+  if ((server_name = getenv("SERVER_NAME")) == NULL)
+    server_name = "SERVER_NAME";
+  if ((server_port = getenv("SERVER_PORT")) == NULL)
+    server_port = "SERVER_PORT";
+
+  CUPS_SRAND(time(NULL));
+  snprintf(buffer, sizeof(buffer), "%s:%s:%s:%02X%02X%02X%02X%02X%02X%02X%02X",
+           remote_addr, server_name, server_port, CUPS_RAND() & 255,
+	   CUPS_RAND() & 255, CUPS_RAND() & 255, CUPS_RAND() & 255,
+	   CUPS_RAND() & 255, CUPS_RAND() & 255, CUPS_RAND() & 255,
+	   CUPS_RAND() & 255);
+  _cupsMD5Init(&md5);
+  _cupsMD5Append(&md5, (unsigned char *)buffer, (int)strlen(buffer));
+  _cupsMD5Finish(&md5, sum);
+  
+  cgiSetCookie(CUPS_SID, httpMD5String(sum, sid), "/", NULL, 0, 0);
+
+  return (cupsGetOption(CUPS_SID, num_cookies, cookies));
+}
+
+
+/*
  * 'cgi_sort_variables()' - Sort all form variables for faster lookup.
  */
 
diff -up cups-1.4.2/config.h.in.CVE-2010-0540 cups-1.4.2/config.h.in
--- cups-1.4.2/config.h.in.CVE-2010-0540	2010-07-16 16:57:40.247073494 +0100
+++ cups-1.4.2/config.h.in	2010-07-16 16:57:40.608948193 +0100
@@ -593,10 +593,24 @@
  * Which random number generator function to use...
  */
 
+#undef HAVE_ARC4RANDOM
 #undef HAVE_RANDOM
-#undef HAVE_MRAND48
 #undef HAVE_LRAND48
 
+#ifdef HAVE_ARC4RANDOM
+#  define CUPS_RAND() arc4random()
+#  define CUPS_SRAND(v) arc4random_stir()
+#elif defined(HAVE_RANDOM)
+#  define CUPS_RAND() random()
+#  define CUPS_SRAND(v) srandom(v)
+#elif defined(HAVE_LRAND48)
+#  define CUPS_RAND() lrand48()
+#  define CUPS_SRAND(v) srand48(v)
+#else
+#  define CUPS_RAND() rand()
+#  define CUPS_SRAND(v) srand(v)
+#endif /* HAVE_ARC4RANDOM */
+
 
 /*
  * Do we have vproc_transaction_begin/end?
diff -up cups-1.4.2/config-scripts/cups-common.m4.CVE-2010-0540 cups-1.4.2/config-scripts/cups-common.m4
--- cups-1.4.2/config-scripts/cups-common.m4.CVE-2010-0540	2009-11-09 23:04:22.000000000 +0000
+++ cups-1.4.2/config-scripts/cups-common.m4	2010-07-16 16:57:40.609948426 +0100
@@ -142,7 +142,7 @@ else
 fi
 
 dnl Check for random number functions...
-AC_CHECK_FUNCS(random mrand48 lrand48)
+AC_CHECK_FUNCS(random lrand48 arc4random)
 
 dnl Check for geteuid function.
 AC_CHECK_FUNCS(geteuid)
diff -up cups-1.4.2/templates/add-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/add-class.tmpl
--- cups-1.4.2/templates/add-class.tmpl.CVE-2010-0540	2008-09-20 04:33:59.000000000 +0100
+++ cups-1.4.2/templates/add-class.tmpl	2010-07-16 16:57:40.609948426 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Add Class</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <TABLE>
diff -up cups-1.4.2/templates/add-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/add-printer.tmpl
--- cups-1.4.2/templates/add-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.266073731 +0100
+++ cups-1.4.2/templates/add-printer.tmpl	2010-07-16 16:57:40.610948422 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Add Printer</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/add-rss-subscription.tmpl.CVE-2010-0540 cups-1.4.2/templates/add-rss-subscription.tmpl
--- cups-1.4.2/templates/add-rss-subscription.tmpl.CVE-2010-0540	2007-08-29 23:23:35.000000000 +0100
+++ cups-1.4.2/templates/add-rss-subscription.tmpl	2010-07-16 16:57:40.610948422 +0100
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">Add RSS Subscription</H2>
diff -up cups-1.4.2/templates/admin.tmpl.CVE-2010-0540 cups-1.4.2/templates/admin.tmpl
--- cups-1.4.2/templates/admin.tmpl.CVE-2010-0540	2010-07-16 16:57:40.300073590 +0100
+++ cups-1.4.2/templates/admin.tmpl	2010-07-16 16:57:40.611948179 +0100
@@ -4,16 +4,16 @@
 <H2 CLASS="title">Printers</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="Add Printer"></FORM>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Find New Printers"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="Add Printer"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Find New Printers"></FORM>
 <FORM ACTION="/printers/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Manage Printers"></FORM>
-{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Export Printers to Samba"></FORM>:}
+{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Export Printers to Samba"></FORM>:}
 </P>
 
 <H2 CLASS="title">Classes</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="Add Class"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="Add Class"></FORM>
 <FORM ACTION="/classes/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Manage Classes"></FORM>
 </P>
 
@@ -28,7 +28,7 @@
 <H2 CLASS="title">Server</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Edit Configuration File"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Edit Configuration File"></FORM>
 <FORM ACTION="/admin/log/access_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="View Access Log"></FORM>
 <FORM ACTION="/admin/log/error_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="View Error Log"></FORM>
 <FORM ACTION="/admin/log/page_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="View Page Log"></FORM>
@@ -38,6 +38,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 {ADVANCEDSETTINGS?<P><B>Server Settings\:</B></P>
 
@@ -95,7 +96,7 @@
 <H2 CLASS="title">RSS Subscriptions</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="Add RSS Subscription"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="Add RSS Subscription"></FORM>
 </P>
 
 </DIV>
@@ -104,6 +105,6 @@
 <THEAD><TR><TH>Name</TH><TH>Events</TH><TH>Queue Name</TH></TR></THEAD>
 <TBODY>{[notify_subscription_id]
 <TR><TD><A HREF="{notify_recipient_uri}">{notify_recipient_name}</A><BR>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="Cancel RSS Subscription"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:All Queues}</TD></TR>}
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="Cancel RSS Subscription"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:All Queues}</TD></TR>}
 </TBODY>
 </TABLE>:}
diff -up cups-1.4.2/templates/choose-device.tmpl.CVE-2010-0540 cups-1.4.2/templates/choose-device.tmpl
--- cups-1.4.2/templates/choose-device.tmpl.CVE-2010-0540	2010-07-16 16:57:46.054073298 +0100
+++ cups-1.4.2/templates/choose-device.tmpl	2010-07-16 16:58:00.759414730 +0100
@@ -6,6 +6,7 @@
 ALT="Busy Indicator"> Looking for printers...</P>}
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
@@ -50,4 +51,4 @@ VALUE="{device_uri}{?device_make_and_mod
 </TABLE>
 
 </FORM>
-</DIV>
\ No newline at end of file
+</DIV>
diff -up cups-1.4.2/templates/choose-make.tmpl.CVE-2010-0540 cups-1.4.2/templates/choose-make.tmpl
--- cups-1.4.2/templates/choose-make.tmpl.CVE-2010-0540	2008-09-20 04:33:59.000000000 +0100
+++ cups-1.4.2/templates/choose-make.tmpl	2010-07-16 16:57:40.612948157 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modify {printer_name}:Add Printer}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/choose-model.tmpl.CVE-2010-0540 cups-1.4.2/templates/choose-model.tmpl
--- cups-1.4.2/templates/choose-model.tmpl.CVE-2010-0540	2008-09-20 04:33:59.000000000 +0100
+++ cups-1.4.2/templates/choose-model.tmpl	2010-07-16 16:57:40.612948157 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modify {printer_name}:Add Printer}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/choose-serial.tmpl.CVE-2010-0540 cups-1.4.2/templates/choose-serial.tmpl
--- cups-1.4.2/templates/choose-serial.tmpl.CVE-2010-0540	2008-09-20 04:33:59.000000000 +0100
+++ cups-1.4.2/templates/choose-serial.tmpl	2010-07-16 16:57:40.613948279 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modify {printer_name}:Add Printer}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/choose-uri.tmpl.CVE-2010-0540 cups-1.4.2/templates/choose-uri.tmpl
--- cups-1.4.2/templates/choose-uri.tmpl.CVE-2010-0540	2009-01-23 22:01:05.000000000 +0000
+++ cups-1.4.2/templates/choose-uri.tmpl	2010-07-16 16:57:40.613948279 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modify {printer_name}:Add Printer}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{?current_make_and_model}">
diff -up cups-1.4.2/templates/class-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/class-confirm.tmpl
--- cups-1.4.2/templates/class-confirm.tmpl.CVE-2010-0540	2008-10-04 16:34:08.000000000 +0100
+++ cups-1.4.2/templates/class-confirm.tmpl	2010-07-16 16:57:40.614948075 +0100
@@ -5,6 +5,6 @@
 <P><B>Warning:</B> Are you sure you want to delete class
 {printer_name}?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Delete Class"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Delete Class"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/class.tmpl.CVE-2010-0540 cups-1.4.2/templates/class.tmpl
--- cups-1.4.2/templates/class.tmpl.CVE-2010-0540	2008-10-05 20:33:44.000000000 +0100
+++ cups-1.4.2/templates/class.tmpl	2010-07-16 16:57:40.614948075 +0100
@@ -5,6 +5,7 @@
 {server_is_sharing_printers=0?Not:{printer_is_shared=0?Not:}} Shared{default_name={printer_name}?, Server Default:})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Maintenance</OPTION>
 <OPTION VALUE="print-test-page">Print Test Page</OPTION>
@@ -17,6 +18,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administration</OPTION>
diff -up cups-1.4.2/templates/de/add-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/add-class.tmpl
--- cups-1.4.2/templates/de/add-class.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/add-class.tmpl	2010-07-16 16:57:40.615948012 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">>Klasse hinzuf&uuml;gen</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <TABLE>
diff -up cups-1.4.2/templates/de/add-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/add-printer.tmpl
--- cups-1.4.2/templates/de/add-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.266073731 +0100
+++ cups-1.4.2/templates/de/add-printer.tmpl	2010-07-16 16:57:40.615948012 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Drucker hinzuf&uuml;gen</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/de/add-rss-subscription.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/add-rss-subscription.tmpl
--- cups-1.4.2/templates/de/add-rss-subscription.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/add-rss-subscription.tmpl	2010-07-16 16:57:40.616948421 +0100
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">>RSS Subskription hinzuf&uuml;gen</H2>
diff -up cups-1.4.2/templates/de/admin.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/admin.tmpl
--- cups-1.4.2/templates/de/admin.tmpl.CVE-2010-0540	2010-07-16 16:57:40.301073186 +0100
+++ cups-1.4.2/templates/de/admin.tmpl	2010-07-16 16:57:40.617948348 +0100
@@ -4,16 +4,16 @@
 <H2 CLASS="title">Drucker</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="Drucker hinzuf&uuml;gen"></FORM>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Verf&uuml;gbare Drucker auflisten"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="Drucker hinzuf&uuml;gen"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Verf&uuml;gbare Drucker auflisten"></FORM>
 <FORM ACTION="/printers/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Drucker verwalten"></FORM>
-{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Drucker f&uuml;r Samba freigeben"></FORM>:}
+{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Drucker f&uuml;r Samba freigeben"></FORM>:}
 </P>
 
 <H2 CLASS="title">Klassen</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="Klasse hinzuf&uuml;gen"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="Klasse hinzuf&uuml;gen"></FORM>
 <FORM ACTION="/classes/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Klassen verwalten"></FORM>
 </P>
 
@@ -28,7 +28,7 @@
 <H2 CLASS="title">Server</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Konfigurationsdatei bearbeiten"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Konfigurationsdatei bearbeiten"></FORM>
 <FORM ACTION="/admin/log/access_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Zugriffsprotokoll betrachten"></FORM>
 <FORM ACTION="/admin/log/error_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Fehlerprotokoll betrachten"></FORM>
 <FORM ACTION="/admin/log/page_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Seitenprotokoll betrachten"></FORM>
@@ -38,6 +38,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 {ADVANCEDSETTINGS?<P><B>Erweiterte Servereinstellungen\:</B></P>
 
@@ -95,7 +96,7 @@
 <H2 CLASS="title">RSS Subskriptionen</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="RSS Subskription hinzuf&uuml;gen"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="RSS Subskription hinzuf&uuml;gen"></FORM>
 </P>
 
 </DIV>
@@ -104,6 +105,6 @@
 <THEAD><TR><TH>Name</TH><TH>Ereignis</TH><TH>Warteschlange</TH></TR></THEAD>
 <TBODY>{[notify_subscription_id]
 <TR><TD><A HREF="{notify_recipient_uri}">{notify_recipient_name}</A><BR>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="RSS Subskription k&uuml;ndigen"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:Alle Warteschlangen}</TD></TR>}
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="RSS Subskription k&uuml;ndigen"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:Alle Warteschlangen}</TD></TR>}
 </TBODY>
 </TABLE>:}
diff -up cups-1.4.2/templates/de/choose-device.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/choose-device.tmpl
--- cups-1.4.2/templates/de/choose-device.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/choose-device.tmpl	2010-07-16 16:57:40.617948348 +0100
@@ -6,6 +6,7 @@
 ALT="Busy Indicator"> Suche nach Druckern...</P>}
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/de/choose-make.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/choose-make.tmpl
--- cups-1.4.2/templates/de/choose-make.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/choose-make.tmpl	2010-07-16 16:57:40.618948239 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?{printer_name} &auml;ndern:Drucker hinzuf&uuml;gen}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/de/choose-model.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/choose-model.tmpl
--- cups-1.4.2/templates/de/choose-model.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/choose-model.tmpl	2010-07-16 16:57:40.618948239 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?{printer_name} &auml;ndern:Drucker hinzuf&uuml;gen}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/de/choose-serial.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/choose-serial.tmpl
--- cups-1.4.2/templates/de/choose-serial.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/choose-serial.tmpl	2010-07-16 16:57:40.619950758 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?{printer_name} &auml;ndern:Drucker hinzuf&uuml;gen}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/de/choose-uri.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/choose-uri.tmpl
--- cups-1.4.2/templates/de/choose-uri.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/choose-uri.tmpl	2010-07-16 16:57:40.619950758 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?{printer_name} &auml;ndern:Drucker hinzuf&uuml;gen}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{?current_make_and_model}">
diff -up cups-1.4.2/templates/de/class-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/class-confirm.tmpl
--- cups-1.4.2/templates/de/class-confirm.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/class-confirm.tmpl	2010-07-16 16:57:40.620948259 +0100
@@ -5,6 +5,6 @@
 <P><B>Warning:</B> Sind Sie sicher Sie wollen die Klasse
 {printer_name} l&ouml;schen?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Klasse l&ouml;schen"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Klasse l&ouml;schen"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/de/class.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/class.tmpl
--- cups-1.4.2/templates/de/class.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/class.tmpl	2010-07-16 16:57:40.621948692 +0100
@@ -5,6 +5,7 @@
 {server_is_sharing_printers=0?Nicht:{printer_is_shared=0?Nicht:}} Freigegeben{default_name={printer_name}?, Standarddrucker:})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Wartung</OPTION>
 <OPTION VALUE="print-test-page">Drucke Testseite</OPTION>
@@ -17,6 +18,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administration</OPTION>
diff -up cups-1.4.2/templates/de/edit-config.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/edit-config.tmpl
--- cups-1.4.2/templates/de/edit-config.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/edit-config.tmpl	2010-07-16 16:57:40.621948692 +0100
@@ -10,7 +10,7 @@ function reset_config()
 <H2 CLASS="title">Konfigurationsdatei &auml;ndern</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -up cups-1.4.2/templates/de/job-move.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/job-move.tmpl
--- cups-1.4.2/templates/de/job-move.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/job-move.tmpl	2010-07-16 16:57:40.622948223 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -up cups-1.4.2/templates/de/jobs.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/jobs.tmpl
--- cups-1.4.2/templates/de/jobs.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/jobs.tmpl	2010-07-16 16:57:40.622948223 +0100
@@ -17,18 +17,18 @@
 <EM>"{job_printer_state_message}"</EM>:}</TD>
 <TD>
 {job_preserved>0?{job_state>5?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Auftrag neu drucken"></FORM>:}:}
 {job_state=4?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Auftrag freigeben"></FORM>:}
 {job_state=3?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Auftrag anhalten"></FORM>:}
 {job_state<7?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Auftrag l&ouml;schen"></FORM>
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Auftrag verschieben"></FORM>:}
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Auftrag verschieben"></FORM>:}
 &nbsp;</TD>
 </TR>
 }
diff -up cups-1.4.2/templates/de/list-available-printers.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/list-available-printers.tmpl
--- cups-1.4.2/templates/de/list-available-printers.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/list-available-printers.tmpl	2010-07-16 16:57:40.623949539 +0100
@@ -4,7 +4,7 @@
 
 {#device_uri=0?<P>Keine Drucker gefunden.</P>
 :<UL>{[device_uri]
-<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="Diesen Drucker hinzuf&uuml;gen"></FORM>
+<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="Diesen Drucker hinzuf&uuml;gen"></FORM>
 {device_make_and_model} ({device_info})</LI>
 }</UL>}
 
diff -up cups-1.4.2/templates/de/modify-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/modify-class.tmpl
--- cups-1.4.2/templates/de/modify-class.tmpl.CVE-2010-0540	2009-08-29 07:05:14.000000000 +0100
+++ cups-1.4.2/templates/de/modify-class.tmpl	2010-07-16 16:57:40.623949539 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Klasse {printer_name} &auml;ndern</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 
diff -up cups-1.4.2/templates/de/modify-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/modify-printer.tmpl
--- cups-1.4.2/templates/de/modify-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.267073467 +0100
+++ cups-1.4.2/templates/de/modify-printer.tmpl	2010-07-16 16:57:40.624948418 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{printer_name} &auml;ndern</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/de/printer-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/printer-confirm.tmpl
--- cups-1.4.2/templates/de/printer-confirm.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/printer-confirm.tmpl	2010-07-16 16:57:40.625948285 +0100
@@ -5,6 +5,6 @@
 <P><B>Warnung:</B> Sind sie sicher sie wollen den Drucker
 {printer_name} l&ouml;schen?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Drucker l&ouml;schen"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Drucker l&ouml;schen"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/de/printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/printer.tmpl
--- cups-1.4.2/templates/de/printer.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/printer.tmpl	2010-07-16 16:57:40.625948285 +0100
@@ -6,6 +6,7 @@
 {server_is_sharing_printers=0?Nicht:{printer_is_shared=0?Nicht:}} freigegeben{default_name={printer_name}?, Standarddrucker:})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Wartung</OPTION>
 <OPTION VALUE="print-test-page">Testseite drucken</OPTION>
@@ -20,6 +21,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administration</OPTION>
diff -up cups-1.4.2/templates/de/samba-export.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/samba-export.tmpl
--- cups-1.4.2/templates/de/samba-export.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/samba-export.tmpl	2010-07-16 16:57:40.626948302 +0100
@@ -10,6 +10,7 @@ function select_printers() {
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Drucker f&uuml;r Samba freigeben</H2>
diff -up cups-1.4.2/templates/de/set-printer-options-header.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/set-printer-options-header.tmpl
--- cups-1.4.2/templates/de/set-printer-options-header.tmpl.CVE-2010-0540	2009-10-26 16:01:08.000000000 +0000
+++ cups-1.4.2/templates/de/set-printer-options-header.tmpl	2010-07-16 16:57:40.626948302 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Standardeinstellungen f&uuml;r {printer_name} festlegen</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {HAVE_AUTOCONFIGURE?<INPUT TYPE="SUBMIT" NAME="AUTOCONFIGURE" VALUE="Drucker nach Standardeinstellungen fragen">:}
diff -up cups-1.4.2/templates/de/users.tmpl.CVE-2010-0540 cups-1.4.2/templates/de/users.tmpl
--- cups-1.4.2/templates/de/users.tmpl.CVE-2010-0540	2009-04-03 16:55:28.000000000 +0100
+++ cups-1.4.2/templates/de/users.tmpl	2010-07-16 16:57:40.627948365 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -up cups-1.4.2/templates/edit-config.tmpl.CVE-2010-0540 cups-1.4.2/templates/edit-config.tmpl
--- cups-1.4.2/templates/edit-config.tmpl.CVE-2010-0540	2008-10-21 06:59:48.000000000 +0100
+++ cups-1.4.2/templates/edit-config.tmpl	2010-07-16 16:57:40.627948365 +0100
@@ -10,7 +10,7 @@ function reset_config()
 <H2 CLASS="title">Edit Configuration File</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -up cups-1.4.2/templates/es/add-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/add-class.tmpl
--- cups-1.4.2/templates/es/add-class.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/add-class.tmpl	2010-07-16 16:57:40.628948307 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">A&ntilde;adir clase</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <TABLE>
diff -up cups-1.4.2/templates/es/add-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/add-printer.tmpl
--- cups-1.4.2/templates/es/add-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.268073850 +0100
+++ cups-1.4.2/templates/es/add-printer.tmpl	2010-07-16 16:57:40.628948307 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">A&ntilde;adir impresora</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/es/add-rss-subscription.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/add-rss-subscription.tmpl
--- cups-1.4.2/templates/es/add-rss-subscription.tmpl.CVE-2010-0540	2009-01-10 00:26:04.000000000 +0000
+++ cups-1.4.2/templates/es/add-rss-subscription.tmpl	2010-07-16 16:57:40.629949101 +0100
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">A&ntilde;adir subscripci&oacute;n RSS</H2>
diff -up cups-1.4.2/templates/es/admin.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/admin.tmpl
--- cups-1.4.2/templates/es/admin.tmpl.CVE-2010-0540	2010-07-16 16:57:40.302073233 +0100
+++ cups-1.4.2/templates/es/admin.tmpl	2010-07-16 16:57:40.630948391 +0100
@@ -4,16 +4,16 @@
 <H2 CLASS="title">Impresoras</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="A&ntilde;adir impresora"></FORM>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Encontrar nuevas impresoras"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="A&ntilde;adir impresora"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Encontrar nuevas impresoras"></FORM>
 <FORM ACTION="/printers/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Administrar impresoras"></FORM>
-{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Exportar impresoras a Samba"></FORM>:}
+{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Exportar impresoras a Samba"></FORM>:}
 </P>
 
 <H2 CLASS="title">Clases</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="A&ntilde;adir clase"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="A&ntilde;adir clase"></FORM>
 <FORM ACTION="/classes/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Administrar clases"></FORM>
 </P>
 
@@ -28,7 +28,7 @@
 <H2 CLASS="title">Servidor</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Editar archivo configuraci&oacute;n"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Editar archivo configuraci&oacute;n"></FORM>
 <FORM ACTION="/admin/log/access_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Ver archivo de registro de accesos"></FORM>
 <FORM ACTION="/admin/log/error_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Ver archivo de registro de errores"></FORM>
 <FORM ACTION="/admin/log/page_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Ver archivo de registro de p&aacute;ginas"></FORM>
@@ -38,6 +38,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 {ADVANCEDSETTINGS?<P><B>Configuraci&oacute;n del servidor\:</B></P>
 
@@ -95,7 +96,7 @@
 <H2 CLASS="title">Subscripciones RSS</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="A&ntilde;adir subscripci&oacute;n RSS"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="A&ntilde;adir subscripci&oacute;n RSS"></FORM>
 </P>
 
 </DIV>
@@ -104,6 +105,6 @@
 <THEAD><TR><TH>Nombre</TH><TH>Eventos</TH><TH>Nombre de la cola</TH></TR></THEAD>
 <TBODY>{[notify_subscription_id]
 <TR><TD><A HREF="{notify_recipient_uri}">{notify_recipient_name}</A><BR>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="Cancelar subscripci&oacute;n RSS"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:Todas las colas}</TD></TR>}
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="Cancelar subscripci&oacute;n RSS"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:Todas las colas}</TD></TR>}
 </TBODY>
 </TABLE>:}
diff -up cups-1.4.2/templates/es/choose-device.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/choose-device.tmpl
--- cups-1.4.2/templates/es/choose-device.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/choose-device.tmpl	2010-07-16 16:57:40.630948391 +0100
@@ -6,6 +6,7 @@
 ALT="Busy Indicator"> Buscando impresoras...</P>}
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/es/choose-make.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/choose-make.tmpl
--- cups-1.4.2/templates/es/choose-make.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/choose-make.tmpl	2010-07-16 16:57:40.631948098 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modificar {printer_name}:A&ntilde;adir impresora}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/es/choose-model.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/choose-model.tmpl
--- cups-1.4.2/templates/es/choose-model.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/choose-model.tmpl	2010-07-16 16:57:40.631948098 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modificar {printer_name}:A&ntilde;adir impresora}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/es/choose-serial.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/choose-serial.tmpl
--- cups-1.4.2/templates/es/choose-serial.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/choose-serial.tmpl	2010-07-16 16:57:40.632948406 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modificar {printer_name}:A&ntilde;adir impresora}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/es/choose-uri.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/choose-uri.tmpl
--- cups-1.4.2/templates/es/choose-uri.tmpl.CVE-2010-0540	2009-01-23 22:01:05.000000000 +0000
+++ cups-1.4.2/templates/es/choose-uri.tmpl	2010-07-16 16:57:40.632948406 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modificar {printer_name}:A&ntilde;adir impresora}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{?current_make_and_model}">
diff -up cups-1.4.2/templates/es/class-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/class-confirm.tmpl
--- cups-1.4.2/templates/es/class-confirm.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/class-confirm.tmpl	2010-07-16 16:57:40.633948508 +0100
@@ -5,6 +5,6 @@
 <P><B>Advertencia:</B> &iquest;Est&aacute; seguro de querer borrar la clase
 {printer_name}?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Borrar clase"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Borrar clase"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/es/class.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/class.tmpl
--- cups-1.4.2/templates/es/class.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/class.tmpl	2010-07-16 16:57:40.634948144 +0100
@@ -5,6 +5,7 @@
 {server_is_sharing_printers=0?no:{printer_is_shared=0?no:}} compartida{default_name={printer_name}?, predeterminada del servidor:})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Mantenimiento</OPTION>
 <OPTION VALUE="print-test-page">Imprimir p&aacute;gina de prueba</OPTION>
@@ -17,6 +18,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administraci&oacute;n</OPTION>
diff -up cups-1.4.2/templates/es/edit-config.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/edit-config.tmpl
--- cups-1.4.2/templates/es/edit-config.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/edit-config.tmpl	2010-07-16 16:57:40.634948144 +0100
@@ -10,7 +10,7 @@ function reset_config()
 <H2 CLASS="title">Editar archivo de configuraci&oacute;n</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -up cups-1.4.2/templates/es/job-move.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/job-move.tmpl
--- cups-1.4.2/templates/es/job-move.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/job-move.tmpl	2010-07-16 16:57:40.635948337 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -up cups-1.4.2/templates/es/jobs.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/jobs.tmpl
--- cups-1.4.2/templates/es/jobs.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/jobs.tmpl	2010-07-16 16:57:40.635948337 +0100
@@ -17,18 +17,18 @@
 <EM>"{job_printer_state_message}"</EM>:}</TD>
 <TD>
 {job_preserved>0?{job_state>5?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Reimprimir trabajo"></FORM>:}:}
 {job_state=4?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Liberar trabajo"></FORM>:}
 {job_state=3?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Retener trabajo"></FORM>:}
 {job_state<7?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Cancelar trabajo"></FORM>
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Mover trabajo"></FORM>:}
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Mover trabajo"></FORM>:}
 &nbsp;</TD>
 </TR>
 }
diff -up cups-1.4.2/templates/es/list-available-printers.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/list-available-printers.tmpl
--- cups-1.4.2/templates/es/list-available-printers.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/list-available-printers.tmpl	2010-07-16 16:57:40.636948470 +0100
@@ -4,7 +4,7 @@
 
 {#device_uri=0?<P>No se encuentran impresoras.</P>
 :<UL>{[device_uri]
-<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="A&ntilde;adir esta impresora"></FORM>
+<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="A&ntilde;adir esta impresora"></FORM>
 {device_make_and_model} ({device_info})</LI>
 }</UL>}
 
diff -up cups-1.4.2/templates/es/modify-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/modify-class.tmpl
--- cups-1.4.2/templates/es/modify-class.tmpl.CVE-2010-0540	2009-08-29 07:05:14.000000000 +0100
+++ cups-1.4.2/templates/es/modify-class.tmpl	2010-07-16 16:57:40.636948470 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Modificar clase {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 
diff -up cups-1.4.2/templates/es/modify-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/modify-printer.tmpl
--- cups-1.4.2/templates/es/modify-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.269073176 +0100
+++ cups-1.4.2/templates/es/modify-printer.tmpl	2010-07-16 16:57:40.637948537 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Modificar {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/es/printer-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/printer-confirm.tmpl
--- cups-1.4.2/templates/es/printer-confirm.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/printer-confirm.tmpl	2010-07-16 16:57:40.637948537 +0100
@@ -5,6 +5,6 @@
 <P><B>Advertencia:</B> &iquest;Est&aacute; seguro de querer borrar la impresora
 {printer_name}?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Borrar impresora"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Borrar impresora"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/es/printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/printer.tmpl
--- cups-1.4.2/templates/es/printer.tmpl.CVE-2010-0540	2009-01-10 00:26:04.000000000 +0000
+++ cups-1.4.2/templates/es/printer.tmpl	2010-07-16 16:57:40.638948834 +0100
@@ -6,6 +6,7 @@
 {server_is_sharing_printers=0?no:{printer_is_shared=0?no:}} compartida{default_name={printer_name}?, predeterminada del servidor:})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Mantenimiento</OPTION>
 <OPTION VALUE="print-test-page">Imprimir p&aacute;gina de prueba</OPTION>
@@ -20,6 +21,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administraci&oacute;n</OPTION>
diff -up cups-1.4.2/templates/es/samba-export.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/samba-export.tmpl
--- cups-1.4.2/templates/es/samba-export.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/samba-export.tmpl	2010-07-16 16:57:40.639948481 +0100
@@ -10,6 +10,7 @@ function select_printers() {
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Exportar impresoras a Samba</H2>
diff -up cups-1.4.2/templates/es/set-printer-options-header.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/set-printer-options-header.tmpl
--- cups-1.4.2/templates/es/set-printer-options-header.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/set-printer-options-header.tmpl	2010-07-16 16:57:40.639948481 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Establecer opciones predeterminadas de {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {HAVE_AUTOCONFIGURE?<INPUT TYPE="SUBMIT" NAME="AUTOCONFIGURE" VALUE="Consultar a la impresora las opciones predeterminadas">:}
diff -up cups-1.4.2/templates/es/users.tmpl.CVE-2010-0540 cups-1.4.2/templates/es/users.tmpl
--- cups-1.4.2/templates/es/users.tmpl.CVE-2010-0540	2008-12-08 21:20:06.000000000 +0000
+++ cups-1.4.2/templates/es/users.tmpl	2010-07-16 16:57:40.640948589 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -up cups-1.4.2/templates/eu/add-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/add-class.tmpl
--- cups-1.4.2/templates/eu/add-class.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/add-class.tmpl	2010-07-16 16:57:40.640948589 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Gehitu klasea</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <TABLE>
diff -up cups-1.4.2/templates/eu/add-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/add-printer.tmpl
--- cups-1.4.2/templates/eu/add-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.269073176 +0100
+++ cups-1.4.2/templates/eu/add-printer.tmpl	2010-07-16 16:57:40.641948535 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Gehitu inprimagailua</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/eu/add-rss-subscription.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/add-rss-subscription.tmpl
--- cups-1.4.2/templates/eu/add-rss-subscription.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/add-rss-subscription.tmpl	2010-07-16 16:57:40.641948535 +0100
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">Gehitu RSS harpidetza</H2>
diff -up cups-1.4.2/templates/eu/admin.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/admin.tmpl
--- cups-1.4.2/templates/eu/admin.tmpl.CVE-2010-0540	2010-07-16 16:57:40.303073937 +0100
+++ cups-1.4.2/templates/eu/admin.tmpl	2010-07-16 16:57:40.642948373 +0100
@@ -4,16 +4,16 @@
 <H2 CLASS="title">Inprimagailuak</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="Gehitu inprimagailua"></FORM>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Bilatu inprimagailu berriak"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="Gehitu inprimagailua"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Bilatu inprimagailu berriak"></FORM>
 <FORM ACTION="/printers/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Kudeatu inprimagailuak"></FORM>
-{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Esportatu inprimagailuak Samba-ra"></FORM>:}
+{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Esportatu inprimagailuak Samba-ra"></FORM>:}
 </P>
 
 <H2 CLASS="title">Klaseak</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="Gehitu klasea"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="Gehitu klasea"></FORM>
 <FORM ACTION="/classes/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Kudeatu klaseak"></FORM>
 </P>
 
@@ -28,7 +28,7 @@
 <H2 CLASS="title">Zerbitzaria</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Editatu konfigurazioko fitxategia"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Editatu konfigurazioko fitxategia"></FORM>
 <FORM ACTION="/admin/log/access_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Ikusi atzipenen egunkaria"></FORM>
 <FORM ACTION="/admin/log/error_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Ikusi erroreen egunkaria"></FORM>
 <FORM ACTION="/admin/log/page_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Ikusi orrialdeen egunkaria"></FORM>
@@ -38,6 +38,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 {ADVANCEDSETTINGS?<P><B>Zerbitzariaren ezarpenak\:</B></P>
 
@@ -95,7 +96,7 @@
 <H2 CLASS="title">RSS harpidetzak</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="Gehitu RSS harpidetza"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="Gehitu RSS harpidetza"></FORM>
 </P>
 
 </DIV>
@@ -104,6 +105,6 @@
 <THEAD><TR><TH>Izena</TH><TH>Gertaerak</TH><TH>Ilararen izena</TH></TR></THEAD>
 <TBODY>{[notify_subscription_id]
 <TR><TD><A HREF="{notify_recipient_uri}">{notify_recipient_name}</A><BR>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="Utzi RSS harpidetza"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:Ilara guztiak}</TD></TR>}
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="Utzi RSS harpidetza"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:Ilara guztiak}</TD></TR>}
 </TBODY>
 </TABLE>:}
diff -up cups-1.4.2/templates/eu/choose-device.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/choose-device.tmpl
--- cups-1.4.2/templates/eu/choose-device.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/choose-device.tmpl	2010-07-16 16:57:40.643948250 +0100
@@ -6,6 +6,7 @@
 ALT="Busy Indicator"> Inprimagailuak bilatzen...</P>}
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/eu/choose-make.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/choose-make.tmpl
--- cups-1.4.2/templates/eu/choose-make.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/choose-make.tmpl	2010-07-16 16:57:40.643948250 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Aldatu {printer_name}:Gehitu inprimagailua}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/eu/choose-model.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/choose-model.tmpl
--- cups-1.4.2/templates/eu/choose-model.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/choose-model.tmpl	2010-07-16 16:57:40.644948377 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Aldatu {printer_name}:Gehitu inprimagailua}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/eu/choose-serial.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/choose-serial.tmpl
--- cups-1.4.2/templates/eu/choose-serial.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/choose-serial.tmpl	2010-07-16 16:57:40.644948377 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Aldatu {printer_name}:Gehitu inprimagailua}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/eu/choose-uri.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/choose-uri.tmpl
--- cups-1.4.2/templates/eu/choose-uri.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/choose-uri.tmpl	2010-07-16 16:57:40.645948248 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Aldatu {printer_name}:Gehitu inprimagailua}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{?current_make_and_model}">
diff -up cups-1.4.2/templates/eu/class-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/class-confirm.tmpl
--- cups-1.4.2/templates/eu/class-confirm.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/class-confirm.tmpl	2010-07-16 16:57:40.645948248 +0100
@@ -4,6 +4,6 @@
 
 <P><B>Abisua:</B> ziur zaude {printer_name} klasea ezabatu nahi duzula?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Ezabatu klasea"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Ezabatu klasea"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/eu/class.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/class.tmpl
--- cups-1.4.2/templates/eu/class.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/class.tmpl	2010-07-16 16:57:40.646948582 +0100
@@ -5,6 +5,7 @@
 {default_name={printer_name}?, zerbitzariaren lehenetsiak:} partekatuta {server_is_sharing_printers=0?ez:{printer_is_shared=0?ez:}} daude)</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Mantenimendua</OPTION>
 <OPTION VALUE="print-test-page">Inprimatu probako orrialdea</OPTION>
@@ -17,6 +18,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administrazioa</OPTION>
diff -up cups-1.4.2/templates/eu/edit-config.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/edit-config.tmpl
--- cups-1.4.2/templates/eu/edit-config.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/edit-config.tmpl	2010-07-16 16:57:40.646948582 +0100
@@ -10,7 +10,7 @@ function reset_config()
 <H2 CLASS="title">Editatu konfigurazioko fitxategia</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -up cups-1.4.2/templates/eu/job-move.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/job-move.tmpl
--- cups-1.4.2/templates/eu/job-move.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/job-move.tmpl	2010-07-16 16:57:40.647948389 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -up cups-1.4.2/templates/eu/jobs.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/jobs.tmpl
--- cups-1.4.2/templates/eu/jobs.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/jobs.tmpl	2010-07-16 16:57:40.648948350 +0100
@@ -17,18 +17,18 @@
 <EM>"{job_printer_state_message}"</EM>:}</TD>
 <TD>
 {job_preserved>0?{job_state>5?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Inprimatu berriro lana"></FORM>:}:}
 {job_state=4?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Askatu lana"></FORM>:}
 {job_state=3?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Eutsi lana"></FORM>:}
 {job_state<7?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Utzi lana"></FORM>
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Aldatu lana lekuz"></FORM>:}
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Aldatu lana lekuz"></FORM>:}
 &nbsp;</TD>
 </TR>
 }
diff -up cups-1.4.2/templates/eu/list-available-printers.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/list-available-printers.tmpl
--- cups-1.4.2/templates/eu/list-available-printers.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/list-available-printers.tmpl	2010-07-16 16:57:40.648948350 +0100
@@ -4,7 +4,7 @@
 
 {#device_uri=0?<P>Ez da inprimagailurik aurkitu.</P>
 :<UL>{[device_uri]
-<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="Gehitu inprimagailu hau"></FORM>
+<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="Gehitu inprimagailu hau"></FORM>
 {device_make_and_model} ({device_info})</LI>
 }</UL>}
 
diff -up cups-1.4.2/templates/eu/modify-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/modify-class.tmpl
--- cups-1.4.2/templates/eu/modify-class.tmpl.CVE-2010-0540	2009-08-29 07:05:14.000000000 +0100
+++ cups-1.4.2/templates/eu/modify-class.tmpl	2010-07-16 16:57:40.649948367 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Aldatu {printer_name} klasea</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 
diff -up cups-1.4.2/templates/eu/modify-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/modify-printer.tmpl
--- cups-1.4.2/templates/eu/modify-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.270073263 +0100
+++ cups-1.4.2/templates/eu/modify-printer.tmpl	2010-07-16 16:57:40.649948367 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Aldatu {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/eu/printer-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/printer-confirm.tmpl
--- cups-1.4.2/templates/eu/printer-confirm.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/printer-confirm.tmpl	2010-07-16 16:57:40.650948140 +0100
@@ -4,6 +4,6 @@
 
 <P><B>Abisua:</B> ziur zaude {printer_name} inprimagailua ezabatzea nahi duzula?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Ezabatu inprimagailua"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Ezabatu inprimagailua"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/eu/printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/printer.tmpl
--- cups-1.4.2/templates/eu/printer.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/printer.tmpl	2010-07-16 16:57:40.650948140 +0100
@@ -6,6 +6,7 @@
 {default_name={printer_name}?, Zerbitzariaren lehenetsia:} partekatuta {server_is_sharing_printers=0?ez:{printer_is_shared=0?ez:}} dago)</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Mantenimendua</OPTION>
 <OPTION VALUE="print-test-page">Inprimatu probako orrialdea</OPTION>
@@ -20,6 +21,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administrazioa</OPTION>
diff -up cups-1.4.2/templates/eu/samba-export.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/samba-export.tmpl
--- cups-1.4.2/templates/eu/samba-export.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/samba-export.tmpl	2010-07-16 16:57:40.651951485 +0100
@@ -10,6 +10,7 @@ function select_printers() {
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Esportatu inprimagailuak Samba-ra</H2>
diff -up cups-1.4.2/templates/eu/set-printer-options-header.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/set-printer-options-header.tmpl
--- cups-1.4.2/templates/eu/set-printer-options-header.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/set-printer-options-header.tmpl	2010-07-16 16:57:40.651951485 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Ezarri {printer_name}(r)en aukera lehenetsiak</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {HAVE_AUTOCONFIGURE?<INPUT TYPE="SUBMIT" NAME="AUTOCONFIGURE" VALUE="Kontsultatu inprimagailuaren aukera lehenetsiei buruz">:}
diff -up cups-1.4.2/templates/eu/users.tmpl.CVE-2010-0540 cups-1.4.2/templates/eu/users.tmpl
--- cups-1.4.2/templates/eu/users.tmpl.CVE-2010-0540	2009-07-07 17:52:34.000000000 +0100
+++ cups-1.4.2/templates/eu/users.tmpl	2010-07-16 16:57:40.652948324 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -up cups-1.4.2/templates/ja/add-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/add-class.tmpl
--- cups-1.4.2/templates/ja/add-class.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/add-class.tmpl	2010-07-16 16:57:40.652948324 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title"></H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <TABLE>
diff -up cups-1.4.2/templates/ja/add-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/add-printer.tmpl
--- cups-1.4.2/templates/ja/add-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.271073085 +0100
+++ cups-1.4.2/templates/ja/add-printer.tmpl	2010-07-16 16:57:40.653948396 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title"></H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/ja/add-rss-subscription.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/add-rss-subscription.tmpl
--- cups-1.4.2/templates/ja/add-rss-subscription.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/add-rss-subscription.tmpl	2010-07-16 16:57:40.654948334 +0100
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">RSS </H2>
diff -up cups-1.4.2/templates/ja/admin.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/admin.tmpl
--- cups-1.4.2/templates/ja/admin.tmpl.CVE-2010-0540	2010-07-16 16:57:40.304073293 +0100
+++ cups-1.4.2/templates/ja/admin.tmpl	2010-07-16 16:57:40.654948334 +0100
@@ -4,16 +4,16 @@
 <H2 CLASS="title"></H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
 <FORM ACTION="/printers/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
-{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE=" Samba "></FORM>:}
+{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE=" Samba "></FORM>:}
 </P>
 
 <H2 CLASS="title"></H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
 <FORM ACTION="/classes/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
 </P>
 
@@ -28,7 +28,7 @@
 <H2 CLASS="title"></H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
 <FORM ACTION="/admin/log/access_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
 <FORM ACTION="/admin/log/error_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
 <FORM ACTION="/admin/log/page_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
@@ -38,6 +38,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 {ADVANCEDSETTINGS?<P><B>\:</B></P>
 
@@ -95,7 +96,7 @@
 <H2 CLASS="title">RSS </H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="RSS "></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="RSS "></FORM>
 </P>
 
 </DIV>
@@ -104,6 +105,6 @@
 <THEAD><TR><TH></TH><TH></TH><TH></TH></TR></THEAD>
 <TBODY>{[notify_subscription_id]
 <TR><TD><A HREF="{notify_recipient_uri}">{notify_recipient_name}</A><BR>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="RSS "></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:}</TD></TR>}
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="RSS "></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:}</TD></TR>}
 </TBODY>
 </TABLE>:}
diff -up cups-1.4.2/templates/ja/choose-device.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/choose-device.tmpl
--- cups-1.4.2/templates/ja/choose-device.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/choose-device.tmpl	2010-07-16 16:57:40.655948687 +0100
@@ -6,6 +6,7 @@
 ALT="Busy Indicator"> ...</P>}
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/ja/choose-make.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/choose-make.tmpl
--- cups-1.4.2/templates/ja/choose-make.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/choose-make.tmpl	2010-07-16 16:57:40.655948687 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?{printer_name}:}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/ja/choose-model.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/choose-model.tmpl
--- cups-1.4.2/templates/ja/choose-model.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/choose-model.tmpl	2010-07-16 16:57:40.656948348 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?{printer_name}:}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/ja/choose-serial.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/choose-serial.tmpl
--- cups-1.4.2/templates/ja/choose-serial.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/choose-serial.tmpl	2010-07-16 16:57:40.657948350 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?{printer_name}:}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/ja/choose-uri.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/choose-uri.tmpl
--- cups-1.4.2/templates/ja/choose-uri.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/choose-uri.tmpl	2010-07-16 16:57:40.657948350 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?{printer_name}:}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{?current_make_and_model}">
diff -up cups-1.4.2/templates/ja/class-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/class-confirm.tmpl
--- cups-1.4.2/templates/ja/class-confirm.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/class-confirm.tmpl	2010-07-16 16:57:40.658948373 +0100
@@ -5,6 +5,6 @@
 <P><B>:</B>  
 {printer_name} </P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE=""></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE=""></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/ja/class.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/class.tmpl
--- cups-1.4.2/templates/ja/class.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/class.tmpl	2010-07-16 16:57:40.658948373 +0100
@@ -5,6 +5,7 @@
 {server_is_sharing_printers=0?:{printer_is_shared=0?:}}{default_name={printer_name}?, :})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE=""></OPTION>
 <OPTION VALUE="print-test-page"></OPTION>
@@ -17,6 +18,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE=""></OPTION>
diff -up cups-1.4.2/templates/ja/edit-config.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/edit-config.tmpl
--- cups-1.4.2/templates/ja/edit-config.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/edit-config.tmpl	2010-07-16 16:57:40.659948325 +0100
@@ -10,7 +10,7 @@ function reset_config()
 <H2 CLASS="title"></H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -up cups-1.4.2/templates/ja/job-move.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/job-move.tmpl
--- cups-1.4.2/templates/ja/job-move.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/job-move.tmpl	2010-07-16 16:57:40.659948325 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -up cups-1.4.2/templates/ja/jobs.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/jobs.tmpl
--- cups-1.4.2/templates/ja/jobs.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/jobs.tmpl	2010-07-16 16:57:40.660948367 +0100
@@ -17,18 +17,18 @@
 <EM>"{job_printer_state_message}"</EM>:}</TD>
 <TD>
 {job_preserved>0?{job_state>5?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE=""></FORM>:}:}
 {job_state=4?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE=""></FORM>:}
 {job_state=3?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE=""></FORM>:}
 {job_state<7?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE=""></FORM>
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE=""></FORM>:}
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE=""></FORM>:}
 &nbsp;</TD>
 </TR>
 }
diff -up cups-1.4.2/templates/ja/list-available-printers.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/list-available-printers.tmpl
--- cups-1.4.2/templates/ja/list-available-printers.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/list-available-printers.tmpl	2010-07-16 16:57:40.660948367 +0100
@@ -4,7 +4,7 @@
 
 {#device_uri=0?<P></P>
 :<UL>{[device_uri]
-<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
+<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE=""></FORM>
 {device_make_and_model} ({device_info})</LI>
 }</UL>}
 
diff -up cups-1.4.2/templates/ja/modify-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/modify-class.tmpl
--- cups-1.4.2/templates/ja/modify-class.tmpl.CVE-2010-0540	2009-08-29 07:05:14.000000000 +0100
+++ cups-1.4.2/templates/ja/modify-class.tmpl	2010-07-16 16:57:40.661948925 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title"> {printer_name} </H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 
diff -up cups-1.4.2/templates/ja/modify-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/modify-printer.tmpl
--- cups-1.4.2/templates/ja/modify-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.271073085 +0100
+++ cups-1.4.2/templates/ja/modify-printer.tmpl	2010-07-16 16:57:40.661948925 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title"> {printer_name} </H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/ja/printer-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/printer-confirm.tmpl
--- cups-1.4.2/templates/ja/printer-confirm.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/printer-confirm.tmpl	2010-07-16 16:57:40.662948407 +0100
@@ -4,6 +4,6 @@
 
 <P><B>:</B>  {printer_name} </P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE=""></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE=""></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/ja/printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/printer.tmpl
--- cups-1.4.2/templates/ja/printer.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/printer.tmpl	2010-07-16 16:57:40.663948198 +0100
@@ -6,6 +6,7 @@
 {server_is_sharing_printers=0?:{printer_is_shared=0?:}}{default_name={printer_name}?, :})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE=""></OPTION>
 <OPTION VALUE="print-test-page"></OPTION>
@@ -20,6 +21,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE=""></OPTION>
diff -up cups-1.4.2/templates/ja/samba-export.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/samba-export.tmpl
--- cups-1.4.2/templates/ja/samba-export.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/samba-export.tmpl	2010-07-16 16:57:40.663948198 +0100
@@ -10,6 +10,7 @@ function select_printers() {
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title"> Samba </H2>
diff -up cups-1.4.2/templates/ja/set-printer-options-header.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/set-printer-options-header.tmpl
--- cups-1.4.2/templates/ja/set-printer-options-header.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/set-printer-options-header.tmpl	2010-07-16 16:57:40.664948360 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{printer_name} </H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {HAVE_AUTOCONFIGURE?<INPUT TYPE="SUBMIT" NAME="AUTOCONFIGURE" VALUE="">:}
diff -up cups-1.4.2/templates/ja/users.tmpl.CVE-2010-0540 cups-1.4.2/templates/ja/users.tmpl
--- cups-1.4.2/templates/ja/users.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ja/users.tmpl	2010-07-16 16:57:40.664948360 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -up cups-1.4.2/templates/job-move.tmpl.CVE-2010-0540 cups-1.4.2/templates/job-move.tmpl
--- cups-1.4.2/templates/job-move.tmpl.CVE-2010-0540	2008-10-05 20:33:44.000000000 +0100
+++ cups-1.4.2/templates/job-move.tmpl	2010-07-16 16:57:40.665948283 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -up cups-1.4.2/templates/jobs.tmpl.CVE-2010-0540 cups-1.4.2/templates/jobs.tmpl
--- cups-1.4.2/templates/jobs.tmpl.CVE-2010-0540	2008-10-05 20:33:44.000000000 +0100
+++ cups-1.4.2/templates/jobs.tmpl	2010-07-16 16:57:40.665948283 +0100
@@ -17,18 +17,17 @@
 <EM>"{job_printer_state_message}"</EM>:}</TD>
 <TD>
 {job_preserved>0?{job_state>5?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
-<INPUT TYPE="SUBMIT" VALUE="Reprint Job"></FORM>:}:}
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}"><INPUT TYPE="SUBMIT" VALUE="Reprint Job"></FORM>:}:}
 {job_state=4?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Release Job"></FORM>:}
 {job_state=3?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Hold Job"></FORM>:}
 {job_state<7?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Cancel Job"></FORM>
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Move Job"></FORM>:}
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Move Job"></FORM>:}
 &nbsp;</TD>
 </TR>
 }
diff -up cups-1.4.2/templates/list-available-printers.tmpl.CVE-2010-0540 cups-1.4.2/templates/list-available-printers.tmpl
--- cups-1.4.2/templates/list-available-printers.tmpl.CVE-2010-0540	2008-09-20 04:33:59.000000000 +0100
+++ cups-1.4.2/templates/list-available-printers.tmpl	2010-07-16 16:57:40.666948706 +0100
@@ -4,7 +4,7 @@
 
 {#device_uri=0?<P>No printers found.</P>
 :<UL>{[device_uri]
-<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="Add This Printer"></FORM>
+<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Local Printer"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="Add This Printer"></FORM>
 {device_make_and_model} ({device_info})</LI>
 }</UL>}
 
diff -up cups-1.4.2/templates/modify-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/modify-class.tmpl
--- cups-1.4.2/templates/modify-class.tmpl.CVE-2010-0540	2009-08-29 07:05:14.000000000 +0100
+++ cups-1.4.2/templates/modify-class.tmpl	2010-07-16 16:57:40.666948706 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Modify Class {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 
diff -up cups-1.4.2/templates/modify-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/modify-printer.tmpl
--- cups-1.4.2/templates/modify-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.273073410 +0100
+++ cups-1.4.2/templates/modify-printer.tmpl	2010-07-16 16:57:40.667948492 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Modify {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/pl/add-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/add-class.tmpl
--- cups-1.4.2/templates/pl/add-class.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/add-class.tmpl	2010-07-16 16:57:40.667948492 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Dodawanie klasy</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <TABLE>
diff -up cups-1.4.2/templates/pl/add-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/add-printer.tmpl
--- cups-1.4.2/templates/pl/add-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.273073410 +0100
+++ cups-1.4.2/templates/pl/add-printer.tmpl	2010-07-16 16:57:40.668948314 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Dodawanie drukarki</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/pl/add-rss-subscription.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/add-rss-subscription.tmpl
--- cups-1.4.2/templates/pl/add-rss-subscription.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/add-rss-subscription.tmpl	2010-07-16 16:57:40.669948332 +0100
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">Dodawanie subskrypcji RSS</H2>
diff -up cups-1.4.2/templates/pl/admin.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/admin.tmpl
--- cups-1.4.2/templates/pl/admin.tmpl.CVE-2010-0540	2010-07-16 16:57:40.304073293 +0100
+++ cups-1.4.2/templates/pl/admin.tmpl	2010-07-16 16:57:40.669948332 +0100
@@ -4,16 +4,16 @@
 <H2 CLASS="title">Drukarki</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="Dodawanie drukarki"></FORM>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Wyszukiwanie nowych drukarek"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE="Dodawanie drukarki"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="Wyszukiwanie nowych drukarek"></FORM>
 <FORM ACTION="/printers/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Zarzdzanie drukarkami"></FORM>
-{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Eksportowanie drukarek do Samby"></FORM>:}
+{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="Eksportowanie drukarek do Samby"></FORM>:}
 </P>
 
 <H2 CLASS="title">Klasy</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="Dodawanie klasy"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE="Dodawanie klasy"></FORM>
 <FORM ACTION="/classes/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Zarzdzanie klasami"></FORM>
 </P>
 
@@ -28,7 +28,7 @@
 <H2 CLASS="title">Serwery</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Modyfikowanie pliku konfiguracji"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="Modyfikowanie pliku konfiguracji"></FORM>
 <FORM ACTION="/admin/log/access_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Przegldanie dziennika dostpu"></FORM>
 <FORM ACTION="/admin/log/error_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Przegldanie dziennika bdw"></FORM>
 <FORM ACTION="/admin/log/page_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="Przegldanie dziennika stron"></FORM>
@@ -38,6 +38,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 {ADVANCEDSETTINGS?<P><B>Ustawienia serwera\:</B></P>
 
@@ -95,7 +96,7 @@
 <H2 CLASS="title">Subskrypcje RSS</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="Dodawanie subskrypcji RSS"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="Dodawanie subskrypcji RSS"></FORM>
 </P>
 
 </DIV>
@@ -104,6 +105,6 @@
 <THEAD><TR><TH>Name</TH><TH>Zdarzenia</TH><TH>Nazwa kolejki</TH></TR></THEAD>
 <TBODY>{[notify_subscription_id]
 <TR><TD><A HREF="{notify_recipient_uri}">{notify_recipient_name}</A><BR>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="Anuluj subskrypcj RSS"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:Wszystkie kolejki}</TD></TR>}
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="Anuluj subskrypcj RSS"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}:Wszystkie kolejki}</TD></TR>}
 </TBODY>
 </TABLE>:}
diff -up cups-1.4.2/templates/pl/choose-device.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/choose-device.tmpl
--- cups-1.4.2/templates/pl/choose-device.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/choose-device.tmpl	2010-07-16 16:57:40.670948584 +0100
@@ -6,6 +6,7 @@
 ALT="Busy Indicator"> Wyszukiwanie drukarek...</P>}
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/pl/choose-make.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/choose-make.tmpl
--- cups-1.4.2/templates/pl/choose-make.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/choose-make.tmpl	2010-07-16 16:57:40.670948584 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modify {printer_name}:Dodawanie drukarki}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/pl/choose-model.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/choose-model.tmpl
--- cups-1.4.2/templates/pl/choose-model.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/choose-model.tmpl	2010-07-16 16:57:40.671948396 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modyfikowanie {printer_name}:Dodawanie drukarki}</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/pl/choose-serial.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/choose-serial.tmpl
--- cups-1.4.2/templates/pl/choose-serial.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/choose-serial.tmpl	2010-07-16 16:57:40.672948563 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modyfikowanie {printer_name}:Dodawanie drukarki}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/pl/choose-uri.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/choose-uri.tmpl
--- cups-1.4.2/templates/pl/choose-uri.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/choose-uri.tmpl	2010-07-16 16:57:40.672948563 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer?Modyfikowanie {printer_name}:Dodawanie drukarki}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{?current_make_and_model}">
diff -up cups-1.4.2/templates/pl/class-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/class-confirm.tmpl
--- cups-1.4.2/templates/pl/class-confirm.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/class-confirm.tmpl	2010-07-16 16:57:40.673948270 +0100
@@ -5,6 +5,6 @@
 <P><B>Ostrzeenie:</B> Usun klas
 {printer_name}?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Usu klas"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Usu klas"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/pl/class.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/class.tmpl
--- cups-1.4.2/templates/pl/class.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/class.tmpl	2010-07-16 16:57:40.673948270 +0100
@@ -5,6 +5,7 @@
 {server_is_sharing_printers=0?Nie:{printer_is_shared=0?Nie:}} Wspdzielona{default_name={printer_name}?, Domylne serwera:})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Konserwacja</OPTION>
 <OPTION VALUE="print-test-page">Drukowanie strony prbnej</OPTION>
@@ -17,6 +18,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administracja</OPTION>
diff -up cups-1.4.2/templates/pl/edit-config.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/edit-config.tmpl
--- cups-1.4.2/templates/pl/edit-config.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/edit-config.tmpl	2010-07-16 16:57:40.674948102 +0100
@@ -10,7 +10,7 @@ function reset_config()
 <H2 CLASS="title">Modyfikowanie pliku konfiguracji</H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -up cups-1.4.2/templates/pl/job-move.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/job-move.tmpl
--- cups-1.4.2/templates/pl/job-move.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/job-move.tmpl	2010-07-16 16:57:40.674948102 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -up cups-1.4.2/templates/pl/jobs.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/jobs.tmpl
--- cups-1.4.2/templates/pl/jobs.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/jobs.tmpl	2010-07-16 16:57:40.675948299 +0100
@@ -17,18 +17,18 @@
 <EM>"{job_printer_state_message}"</EM>:}</TD>
 <TD>
 {job_preserved>0?{job_state>5?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Ponownie wydrukuj zadanie"></FORM>:}:}
 {job_state=4?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Zwolnij zadanie"></FORM>:}
 {job_state=3?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Wstrzymaj zadanie"></FORM>:}
 {job_state<7?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE="Anuluj zadanie"></FORM>
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Przenie zadanie"></FORM>:}
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE="Przenie zadanie"></FORM>:}
 &nbsp;</TD>
 </TR>
 }
diff -up cups-1.4.2/templates/pl/list-available-printers.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/list-available-printers.tmpl
--- cups-1.4.2/templates/pl/list-available-printers.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/list-available-printers.tmpl	2010-07-16 16:57:40.675948299 +0100
@@ -4,7 +4,7 @@
 
 {#device_uri=0?<P>Nie znaleziono drukarek.</P>
 :<UL>{[device_uri]
-<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Lokalna drukarka"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="Dodaj t drukark"></FORM>
+<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE="Lokalna drukarka"><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="Dodaj t drukark"></FORM>
 {device_make_and_model} ({device_info})</LI>
 }</UL>}
 
diff -up cups-1.4.2/templates/pl/modify-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/modify-class.tmpl
--- cups-1.4.2/templates/pl/modify-class.tmpl.CVE-2010-0540	2009-08-29 07:05:14.000000000 +0100
+++ cups-1.4.2/templates/pl/modify-class.tmpl	2010-07-16 16:57:40.676948642 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Modyfikowanie klasy {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 
diff -up cups-1.4.2/templates/pl/modify-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/modify-printer.tmpl
--- cups-1.4.2/templates/pl/modify-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.274072791 +0100
+++ cups-1.4.2/templates/pl/modify-printer.tmpl	2010-07-16 16:57:40.676948642 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Modyfikowanie {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/pl/printer-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/printer-confirm.tmpl
--- cups-1.4.2/templates/pl/printer-confirm.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/printer-confirm.tmpl	2010-07-16 16:57:40.677948359 +0100
@@ -5,6 +5,6 @@
 <P><B>Ostrzeenie:</B> usun drukark
 {printer_name}?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Usu drukark"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Usu drukark"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/pl/printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/printer.tmpl
--- cups-1.4.2/templates/pl/printer.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/printer.tmpl	2010-07-16 16:57:40.678948291 +0100
@@ -6,6 +6,7 @@
 {server_is_sharing_printers=0?Nie:{printer_is_shared=0?Nie:}} Wspdzielona{default_name={printer_name}?, Domylne serwera:})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Konserwacja</OPTION>
 <OPTION VALUE="print-test-page">Wydrukuj stron prbn</OPTION>
@@ -20,6 +21,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administracja</OPTION>
diff -up cups-1.4.2/templates/pl/samba-export.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/samba-export.tmpl
--- cups-1.4.2/templates/pl/samba-export.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/samba-export.tmpl	2010-07-16 16:57:40.681947721 +0100
@@ -10,6 +10,7 @@ function select_printers() {
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Eksportowanie drukarek do Samby</H2>
diff -up cups-1.4.2/templates/pl/set-printer-options-header.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/set-printer-options-header.tmpl
--- cups-1.4.2/templates/pl/set-printer-options-header.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/set-printer-options-header.tmpl	2010-07-16 16:57:40.681947721 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Ustawianie domylnych opcji dla {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {HAVE_AUTOCONFIGURE?<INPUT TYPE="SUBMIT" NAME="AUTOCONFIGURE" VALUE="Zakolejkuj drukark do domylnych opcji">:}
diff -up cups-1.4.2/templates/pl/users.tmpl.CVE-2010-0540 cups-1.4.2/templates/pl/users.tmpl
--- cups-1.4.2/templates/pl/users.tmpl.CVE-2010-0540	2009-02-25 16:48:35.000000000 +0000
+++ cups-1.4.2/templates/pl/users.tmpl	2010-07-16 16:57:40.683073011 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -up cups-1.4.2/templates/printer-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/printer-confirm.tmpl
--- cups-1.4.2/templates/printer-confirm.tmpl.CVE-2010-0540	2008-10-04 16:34:08.000000000 +0100
+++ cups-1.4.2/templates/printer-confirm.tmpl	2010-07-16 16:57:40.683948272 +0100
@@ -5,6 +5,6 @@
 <P><B>Warning:</B> Are you sure you want to delete printer
 {printer_name}?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Delete Printer"></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE="Delete Printer"></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/printer.tmpl
--- cups-1.4.2/templates/printer.tmpl.CVE-2010-0540	2008-10-05 20:33:44.000000000 +0100
+++ cups-1.4.2/templates/printer.tmpl	2010-07-16 16:57:40.683948272 +0100
@@ -6,6 +6,7 @@
 {server_is_sharing_printers=0?Not:{printer_is_shared=0?Not:}} Shared{default_name={printer_name}?, Server Default:})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE="">Maintenance</OPTION>
 <OPTION VALUE="print-test-page">Print Test Page</OPTION>
@@ -20,6 +21,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE="">Administration</OPTION>
diff -up cups-1.4.2/templates/ru/add-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/add-class.tmpl
--- cups-1.4.2/templates/ru/add-class.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/add-class.tmpl	2010-07-16 16:57:40.684948691 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title"> </H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 
 <TABLE>
diff -up cups-1.4.2/templates/ru/add-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/add-printer.tmpl
--- cups-1.4.2/templates/ru/add-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.275073068 +0100
+++ cups-1.4.2/templates/ru/add-printer.tmpl	2010-07-16 16:57:40.684948691 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title"> </H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/ru/add-rss-subscription.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/add-rss-subscription.tmpl
--- cups-1.4.2/templates/ru/add-rss-subscription.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/add-rss-subscription.tmpl	2010-07-16 16:57:40.685948352 +0100
@@ -1,4 +1,5 @@
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription">
 
 <H2 CLASS="title">   RSS</H2>
diff -up cups-1.4.2/templates/ru/admin.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/admin.tmpl
--- cups-1.4.2/templates/ru/admin.tmpl.CVE-2010-0540	2010-07-16 16:57:40.306073101 +0100
+++ cups-1.4.2/templates/ru/admin.tmpl	2010-07-16 16:57:40.686948384 +0100
@@ -4,16 +4,16 @@
 <H2 CLASS="title"></H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE=" "></FORM>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="  "></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="SUBMIT" VALUE=" "></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="find-new-printers"><INPUT TYPE="SUBMIT" VALUE="  "></FORM>
 <FORM ACTION="/printers/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE=" "></FORM>
-{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="   Samba"></FORM>:}
+{have_samba?<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba"><INPUT TYPE="SUBMIT" VALUE="   Samba"></FORM>:}
 </P>
 
 <H2 CLASS="title"></H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE=" "></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-class"><INPUT TYPE="SUBMIT" VALUE=" "></FORM>
 <FORM ACTION="/classes/" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE=" "></FORM>
 </P>
 
@@ -28,7 +28,7 @@
 <H2 CLASS="title"></H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="  "></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server"><INPUT TYPE="SUBMIT" VALUE="  "></FORM>
 <FORM ACTION="/admin/log/access_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="  "></FORM>
 <FORM ACTION="/admin/log/error_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="  "></FORM>
 <FORM ACTION="/admin/log/page_log" METHOD="GET"><INPUT TYPE="SUBMIT" VALUE="  "></FORM>
@@ -38,6 +38,7 @@
 <BLOCKQUOTE>{SETTINGS_ERROR}</BLOCKQUOTE>:
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 
 {ADVANCEDSETTINGS?<P><B> \:</B></P>
 
@@ -95,7 +96,7 @@
 <H2 CLASS="title">  RSS</H2>
 
 <P>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="   RSS"></FORM>
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-rss-subscription"><INPUT TYPE="SUBMIT" VALUE="   RSS"></FORM>
 </P>
 
 </DIV>
@@ -104,6 +105,6 @@
 <THEAD><TR><TH></TH><TH></TH><TH></TH></TR></THEAD>
 <TBODY>{[notify_subscription_id]
 <TR><TD><A HREF="{notify_recipient_uri}">{notify_recipient_name}</A><BR>
-<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="   RSS"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}: }</TD></TR>}
+<FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-subscription"><INPUT TYPE="HIDDEN" NAME="notify_subscription_id" VALUE="{notify_subscription_id}"><INPUT TYPE="SUBMIT" VALUE="   RSS"></FORM>&nbsp;</TD><TD>{notify_events}</TD><TD NOWRAP>&nbsp;{notify_printer_name?{notify_printer_name}: }</TD></TR>}
 </TBODY>
 </TABLE>:}
diff -up cups-1.4.2/templates/ru/choose-device.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/choose-device.tmpl
--- cups-1.4.2/templates/ru/choose-device.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/choose-device.tmpl	2010-07-16 16:57:40.686948384 +0100
@@ -6,6 +6,7 @@
 ALT="Busy Indicator">  ...</P>}
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/ru/choose-make.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/choose-make.tmpl
--- cups-1.4.2/templates/ru/choose-make.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/choose-make.tmpl	2010-07-16 16:57:40.687948140 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer? {printer_name}: }</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/ru/choose-model.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/choose-model.tmpl
--- cups-1.4.2/templates/ru/choose-model.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/choose-model.tmpl	2010-07-16 16:57:40.687948140 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer? {printer_name}: }</H2>
 
 <FORM METHOD="POST" ACTION="/admin" ENCTYPE="multipart/form-data">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
diff -up cups-1.4.2/templates/ru/choose-serial.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/choose-serial.tmpl
--- cups-1.4.2/templates/ru/choose-serial.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/choose-serial.tmpl	2010-07-16 16:57:40.688948840 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer? {printer_name}: }</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 
diff -up cups-1.4.2/templates/ru/choose-uri.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/choose-uri.tmpl
--- cups-1.4.2/templates/ru/choose-uri.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/choose-uri.tmpl	2010-07-16 16:57:40.688948840 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">{op=modify-printer? {printer_name}: }</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {printer_name?<INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">:}
 <INPUT TYPE="HIDDEN" NAME="CURRENT_MAKE_AND_MODEL" VALUE="{?current_make_and_model}">
diff -up cups-1.4.2/templates/ru/class-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/class-confirm.tmpl
--- cups-1.4.2/templates/ru/class-confirm.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/class-confirm.tmpl	2010-07-16 16:57:40.689948606 +0100
@@ -5,6 +5,6 @@
 <P><B>:</B>     
 {printer_name}?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE=" "></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="op" VALUE="delete-class"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE=" "></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/ru/class.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/class.tmpl
--- cups-1.4.2/templates/ru/class.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/class.tmpl	2010-07-16 16:57:40.690948302 +0100
@@ -5,6 +5,7 @@
 {server_is_sharing_printers=0?  :{printer_is_shared=0?  :  }})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE=""></OPTION>
 <OPTION VALUE="print-test-page">  </OPTION>
@@ -17,6 +18,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE=""></OPTION>
diff -up cups-1.4.2/templates/ru/edit-config.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/edit-config.tmpl
--- cups-1.4.2/templates/ru/edit-config.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/edit-config.tmpl	2010-07-16 16:57:40.690948302 +0100
@@ -10,7 +10,7 @@ function reset_config()
 <H2 CLASS="title">  </H2>
 
 <FORM NAME="cups" METHOD="POST" ACTION="/admin/">
-
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="config-server">
 
 <TEXTAREA NAME="CUPSDCONF" COLS="80" ROWS="25">{CUPSDCONF}</TEXTAREA>
diff -up cups-1.4.2/templates/ru/job-move.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/job-move.tmpl
--- cups-1.4.2/templates/ru/job-move.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/job-move.tmpl	2010-07-16 16:57:40.691948409 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/{SECTION}/{job_id?:{printer_name}}">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {job_id?<INPUT TYPE="HIDDEN" NAME="JOB_ID" VALUE="{job_id}">:}
 
diff -up cups-1.4.2/templates/ru/jobs.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/jobs.tmpl
--- cups-1.4.2/templates/ru/jobs.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/jobs.tmpl	2010-07-16 16:57:40.691948409 +0100
@@ -17,18 +17,18 @@
 <EM>"{job_printer_state_message}"</EM>:}</TD>
 <TD>
 {job_preserved>0?{job_state>5?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="restart-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE=""></FORM>:}:}
 {job_state=4?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="release-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE=""></FORM>:}
 {job_state=3?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="hold-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE=""></FORM>:}
 {job_state<7?
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="cancel-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="HIDDEN" NAME="job_printer_uri" VALUE="{job_printer_uri}">
 <INPUT TYPE="SUBMIT" VALUE=""></FORM>
-<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE=""></FORM>:}
+<FORM ACTION="/jobs/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="move-job"><INPUT TYPE="HIDDEN" NAME="job_id" VALUE="{job_id}"><INPUT TYPE="SUBMIT" VALUE=""></FORM>:}
 &nbsp;</TD>
 </TR>
 }
diff -up cups-1.4.2/templates/ru/list-available-printers.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/list-available-printers.tmpl
--- cups-1.4.2/templates/ru/list-available-printers.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/list-available-printers.tmpl	2010-07-16 16:57:40.692948302 +0100
@@ -4,7 +4,7 @@
 
 {#device_uri=0?<P>    .</P>
 :<UL>{[device_uri]
-<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE=" "><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="  "></FORM>
+<LI><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="add-printer"><INPUT TYPE="HIDDEN" NAME="TEMPLATE_NAME" VALUE="{template_name}"><INPUT TYPE="HIDDEN" NAME="PRINTER_LOCATION" VALUE=" "><INPUT TYPE="HIDDEN" NAME="PRINTER_INFO" VALUE="{device_make_and_model}"><INPUT TYPE="HIDDEN" NAME="DEVICE_URI" VALUE="{device_uri}"><INPUT TYPE="SUBMIT" VALUE="  "></FORM>
 {device_make_and_model} ({device_info})</LI>
 }</UL>}
 
diff -up cups-1.4.2/templates/ru/modify-class.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/modify-class.tmpl
--- cups-1.4.2/templates/ru/modify-class.tmpl.CVE-2010-0540	2009-08-29 07:05:14.000000000 +0100
+++ cups-1.4.2/templates/ru/modify-class.tmpl	2010-07-16 16:57:40.692948302 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">  {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 
diff -up cups-1.4.2/templates/ru/modify-printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/modify-printer.tmpl
--- cups-1.4.2/templates/ru/modify-printer.tmpl.CVE-2010-0540	2010-07-16 16:57:40.275073068 +0100
+++ cups-1.4.2/templates/ru/modify-printer.tmpl	2010-07-16 16:57:40.693950179 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">  {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 <INPUT TYPE="HIDDEN" NAME="BAUDRATE" VALUE="{?baudrate}">
 <INPUT TYPE="HIDDEN" NAME="BITS" VALUE="{?bits}">
diff -up cups-1.4.2/templates/ru/printer-confirm.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/printer-confirm.tmpl
--- cups-1.4.2/templates/ru/printer-confirm.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/printer-confirm.tmpl	2010-07-16 16:57:40.693950179 +0100
@@ -5,6 +5,6 @@
 <P><B>:</B>     
 {printer_name}?</P>
 
-<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE=" "></FORM></P>
+<P ALIGN="CENTER"><FORM ACTION="/admin/" METHOD="POST"><INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}"><INPUT TYPE="HIDDEN" NAME="OP" VALUE="delete-printer"><INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}"><INPUT TYPE="SUBMIT" NAME="confirm" VALUE=" "></FORM></P>
 
 </DIV>
diff -up cups-1.4.2/templates/ru/printer.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/printer.tmpl
--- cups-1.4.2/templates/ru/printer.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/printer.tmpl	2010-07-16 16:57:40.694948241 +0100
@@ -6,6 +6,7 @@
 {server_is_sharing_printers=0?  :{printer_is_shared=0?  :  }})</H2>
 
 <FORM METHOD="POST" ACTION="{printer_uri_supported}" NAME="maintenance">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <SELECT NAME="OP" ONCHANGE="document.maintenance.submit();">
 <OPTION VALUE=""></OPTION>
 <OPTION VALUE="print-test-page">  </OPTION>
@@ -20,6 +21,7 @@
 </FORM>
 
 <FORM METHOD="POST" ACTION="{admin_uri}" NAME="administration">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="printer_name" VALUE="{printer_name}">
 <SELECT NAME="OP" ONCHANGE="document.administration.submit();">
 <OPTION VALUE=""></OPTION>
diff -up cups-1.4.2/templates/ru/samba-export.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/samba-export.tmpl
--- cups-1.4.2/templates/ru/samba-export.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/samba-export.tmpl	2010-07-16 16:57:40.695948503 +0100
@@ -10,6 +10,7 @@ function select_printers() {
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">   Samba</H2>
diff -up cups-1.4.2/templates/ru/set-printer-options-header.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/set-printer-options-header.tmpl
--- cups-1.4.2/templates/ru/set-printer-options-header.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/set-printer-options-header.tmpl	2010-07-16 16:57:40.695948503 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">     {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {HAVE_AUTOCONFIGURE?<INPUT TYPE="SUBMIT" NAME="AUTOCONFIGURE" VALUE="     ">:}
diff -up cups-1.4.2/templates/ru/users.tmpl.CVE-2010-0540 cups-1.4.2/templates/ru/users.tmpl
--- cups-1.4.2/templates/ru/users.tmpl.CVE-2010-0540	2009-02-17 19:04:25.000000000 +0000
+++ cups-1.4.2/templates/ru/users.tmpl	2010-07-16 16:57:40.696948411 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
diff -up cups-1.4.2/templates/samba-export.tmpl.CVE-2010-0540 cups-1.4.2/templates/samba-export.tmpl
--- cups-1.4.2/templates/samba-export.tmpl.CVE-2010-0540	2007-08-29 23:23:35.000000000 +0100
+++ cups-1.4.2/templates/samba-export.tmpl	2010-07-16 16:57:40.696948411 +0100
@@ -10,6 +10,7 @@ function select_printers() {
 --></SCRIPT>
 
 <FORM METHOD="POST" ACTION="/admin/" NAME="export_samba">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="export-samba">
 
 <H2 CLASS="title">Export Printers to Samba</H2>
diff -up cups-1.4.2/templates/set-printer-options-header.tmpl.CVE-2010-0540 cups-1.4.2/templates/set-printer-options-header.tmpl
--- cups-1.4.2/templates/set-printer-options-header.tmpl.CVE-2010-0540	2008-10-05 05:50:17.000000000 +0100
+++ cups-1.4.2/templates/set-printer-options-header.tmpl	2010-07-16 16:57:40.697948243 +0100
@@ -3,6 +3,7 @@
 <H2 CLASS="title">Set Default Options for {printer_name}</H2>
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{op}">
 {HAVE_AUTOCONFIGURE?<INPUT TYPE="SUBMIT" NAME="AUTOCONFIGURE" VALUE="Query Printer for Default Options">:}
diff -up cups-1.4.2/templates/users.tmpl.CVE-2010-0540 cups-1.4.2/templates/users.tmpl
--- cups-1.4.2/templates/users.tmpl.CVE-2010-0540	2008-09-20 04:33:59.000000000 +0100
+++ cups-1.4.2/templates/users.tmpl	2010-07-16 16:57:40.697948243 +0100
@@ -1,6 +1,7 @@
 <DIV CLASS="indent">
 
 <FORM METHOD="POST" ACTION="/admin">
+<INPUT TYPE="HIDDEN" NAME="org.cups.sid" VALUE="{$org.cups.sid}">
 <INPUT TYPE="HIDDEN" NAME="OP" VALUE="{OP}">
 <INPUT TYPE="HIDDEN" NAME="PRINTER_NAME" VALUE="{printer_name}">
 {IS_CLASS?<INPUT TYPE="HIDDEN" NAME="IS_CLASS" VALUE="{IS_CLASS}">:}
